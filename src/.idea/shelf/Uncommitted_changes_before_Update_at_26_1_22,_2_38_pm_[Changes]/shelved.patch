Index: application/Controllers/admin/admin_ruri.py
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>import datetime\nimport traceback\n\nimport flask\nfrom flask import render_template, request, redirect, url_for, session, flash, \\\n    Flask\nfrom flask_login import logout_user, login_required, current_user\nimport os\nimport os.path\n\nfrom application.CouponForms import CreateCouponForm\nfrom application.Models.Admin import *\nfrom application.Models.CouponSystem import CouponSystem\nfrom application.Models.Certification import Certification\nfrom application.Models.Food import Food\nfrom application.Models.Restaurant import Restaurant\nfrom application import app, login_manager\nfrom application.Models.Transaction import Transaction\nfrom application.adminAddFoodForm import CreateFoodForm\nfrom werkzeug.utils import secure_filename\nfrom application.Models.RestaurantSystem import *\nimport shelve, os\nimport uuid\nfrom application.rest_details_form import *\n\n# Ruri's imported libraries\nimport urllib.request\nimport os\nfrom werkzeug.utils import secure_filename\n\n\n# <------------------------- RURI ------------------------------>\n# C (Create)\n@app.route('/admin/create-restaurant', methods=['GET', 'POST'])\n@login_required\ndef admin_myrestaurant():  # ruri\n    restaurant_details_form = RestaurantDetailsForm(\n        request.form)  # Using the Create Restaurant Form\n    # The controller will be the place where we do all the interaction\n    if request.method == 'POST' and restaurant_details_form.validate():\n        # Checks if a restaurant has already been created by the current admin\n        if not current_user.restaurant_id:\n\n            #  The Below code is using one of the controller's method\n            #  \"Create_restaurant\"\n            # It's passing in the form argument to instantiate the restaurant\n            # object\n            # hygiene = request.files['hygieneDocument']\n            # hygieneFile = secure_filename(hygiene.filename)\n            # os.makedirs(os.path.join(os.getcwd(), os.path.dirname(app.config['UPLOADED_PDF'])), exist_ok=True)\n            # hygiene.save(os.path.join(os.getcwd(), app.config[\n            #     'UPLOADED_PDF']) + hygieneFile)\n            # logging.info('Hygiene -- file uploaded successfully')\n            # save_hygiene = f\"application/static/restaurantCertification/{restaurant_id}/{hygieneFile}\"\n\n            # print(current_user.restaurant_id)\n            restaurant = RestaurantSystem.create_restaurant(\n                restaurant_details_form.rest_name.data,\n                request.form.get(\"rest_logo\"),\n                restaurant_details_form.rest_contact.data,\n                restaurant_details_form.rest_hour_open.data,\n                restaurant_details_form.rest_hour_close.data,\n                restaurant_details_form.rest_address1.data,\n                restaurant_details_form.rest_address2.data,\n                restaurant_details_form.rest_postcode.data,\n                restaurant_details_form.rest_desc.data,\n                restaurant_details_form.rest_bank.data,\n                restaurant_details_form.rest_del1.data,\n                restaurant_details_form.rest_del2.data,\n                restaurant_details_form.rest_del3.data,\n                restaurant_details_form.rest_del4.data,\n                restaurant_details_form.rest_del5.data,\n            )\n            current_user.restaurant_id = restaurant.id\n\n        else:\n            restaurant = RestaurantSystem.find_restaurant_by_id(current_user.restaurant_id)\n            RestaurantSystem.edit_restaurant(\n                restaurant,\n                restaurant_details_form.rest_name.data,\n                request.form.get(\"rest_logo\"),\n                restaurant_details_form.rest_contact.data,\n                restaurant_details_form.rest_hour_open.data,\n                restaurant_details_form.rest_hour_close.data,\n                restaurant_details_form.rest_address1.data,\n                restaurant_details_form.rest_address2.data,\n                restaurant_details_form.rest_postcode.data,\n                restaurant_details_form.rest_desc.data,\n                restaurant_details_form.rest_bank.data,\n                restaurant_details_form.rest_del1.data,\n                restaurant_details_form.rest_del2.data,\n                restaurant_details_form.rest_del3.data,\n                restaurant_details_form.rest_del4.data,\n                restaurant_details_form.rest_del5.data,\n            )\n\n        # ashlee - attach restaurant_id to our current user\n        # current_user.restaurant_id = restaurant_id\n        # print(current_user.restaurant_id)\n        # Certification.restaurant_id = restaurant_id\n        # Food.restaurant_id = restaurant_id\n        # print(Certification.restaurant_id)\n        # print(restaurant_id)\n        # print(Food.restaurant_id)\n        # RestaurantSystem.get_restaurant_by_id(current_user.restaurant_id)\n\n        # flask_login.current_user.restaurant = restaurant_id\n        # Once done, it'll redirect to the home page\n        return redirect(url_for('test_upload'))\n\n    # Load current restaurant's variables if the restaurant created before.\n    if current_user.restaurant_id is not None:\n        restaurant = RestaurantSystem.find_restaurant_by_id(current_user.restaurant_id)\n        restaurant_details_form.rest_name.data = restaurant.name\n        restaurant_details_form.rest_contact.data = restaurant.contact\n        restaurant_details_form.rest_hour_open.data = restaurant.open\n        restaurant_details_form.rest_hour_close.data = restaurant.close\n        restaurant_details_form.rest_address1.data = restaurant.add1\n        restaurant_details_form.rest_address2.data = restaurant.add2\n        restaurant_details_form.rest_postcode.data = restaurant.postc\n        restaurant_details_form.rest_desc.data = restaurant.desc\n        restaurant_details_form.rest_bank.data = restaurant.bank\n        restaurant_details_form.rest_del1.data = restaurant.del1\n        restaurant_details_form.rest_del2.data = restaurant.del2\n        restaurant_details_form.rest_del3.data = restaurant.del3\n        restaurant_details_form.rest_del4.data = restaurant.del4\n        restaurant_details_form.rest_del5.data = restaurant.del5\n\n    return render_template(\"admin/restaurant.html\",\n                           form=restaurant_details_form,\n                           restaurant=all_restaurant())\n\n\n# R (Read)\n# This is the route that displays all the relevant restaurant details\n@app.route('/admin/my-restaurant')\ndef view_restaurant():\n    return render_template('admin/myrestaurantv2.html',\n                           restaurant=all_restaurant())\n\n\n# U (Update Form) # This route is to showcase the update route\n# This route contains the form that allows us to update the restaurant details\n@app.route('/updateRestaurant/<id>', methods=['GET', 'POST'])\ndef update_restaurant(id):\n    edit_restaurant = RestaurantDetailsForm(request.form)\n    restaurant = filter(lambda r: r.get_id() == id,\n                        all_restaurant())  # Array Filtering that allows me\n    # to track which restaurant the restaurant belongs to for example (ID 1\n    # == ID 1)\n    # This lambda is a callback function, it's pretty much comparing if the\n    # ID of the restaurant is equal to our id argument\n    if request.method == 'POST' and edit_restaurant.validate():\n        return render_template('admin/updateuserv2.html', form=edit_restaurant,\n                               restaurant=restaurant)\n    return render_template('admin/updateuserv2.html', form=edit_restaurant,\n                           restaurant=all_restaurant())\n\n\n# U (Update)\n@app.route('/updateRestaurantConfirm/<id>', methods=['GET', 'POST'])\ndef update_restaurant_confirm(id):\n    edit_restaurant = RestaurantDetailsForm(request.form)\n    editing_restaurant = RestaurantSystem()\n    if request.method == 'POST' and edit_restaurant.validate():\n        editing_restaurant.edit_restaurant(\n            id,\n            edit_restaurant.rest_name.data,\n            request.form.get(\"rest_logo\"),\n            edit_restaurant.rest_contact.data,\n            edit_restaurant.rest_hour_open.data,\n            edit_restaurant.rest_hour_close.data,\n            edit_restaurant.rest_address1.data,\n            edit_restaurant.rest_address2.data,\n            edit_restaurant.rest_postcode.data,\n            edit_restaurant.rest_desc.data,\n            edit_restaurant.rest_bank.data,\n            edit_restaurant.rest_del1.data,\n            edit_restaurant.rest_del2.data,\n            edit_restaurant.rest_del3.data,\n            edit_restaurant.rest_del4.data,\n            edit_restaurant.rest_del5.data\n        )\n    return redirect(url_for('view_restaurant'))\n\n\n@app.route(\"/admin/dashboard\")\ndef dashboard():  # ruri\n    return render_template(\"admin/dashboard.html\")\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/application/Controllers/admin/admin_ruri.py b/application/Controllers/admin/admin_ruri.py
--- a/application/Controllers/admin/admin_ruri.py	(revision 40420adf25f454adf4c2c46c8eb7fbadbb8da3fd)
+++ b/application/Controllers/admin/admin_ruri.py	(date 1643178115559)
@@ -28,7 +28,7 @@
 import os
 from werkzeug.utils import secure_filename
 
-
+app.config["IMAGE_UPLOADS"] = "src/application/static/restaurantLogos"
 # <------------------------- RURI ------------------------------>
 # C (Create)
 @app.route('/admin/create-restaurant', methods=['GET', 'POST'])
@@ -39,6 +39,12 @@
     # The controller will be the place where we do all the interaction
     if request.method == 'POST' and restaurant_details_form.validate():
         # Checks if a restaurant has already been created by the current admin
+        rest_logo = request.files.get("rest_logo")
+        os_path = app.instance_path
+        fileName = rest_logo.filename
+        upload_path = "/src/application/static/restaurantLogos/abc.png"
+        rest_logo.save(os_path)
+
         if not current_user.restaurant_id:
 
             #  The Below code is using one of the controller's method
@@ -56,7 +62,8 @@
             # print(current_user.restaurant_id)
             restaurant = RestaurantSystem.create_restaurant(
                 restaurant_details_form.rest_name.data,
-                request.form.get("rest_logo"),
+                # request.form.get("rest_logo"),
+                rest_logo,
                 restaurant_details_form.rest_contact.data,
                 restaurant_details_form.rest_hour_open.data,
                 restaurant_details_form.rest_hour_close.data,
@@ -72,6 +79,7 @@
                 restaurant_details_form.rest_del5.data,
             )
             current_user.restaurant_id = restaurant.id
+            print(request.files.get["rest_logo"])
 
         else:
             restaurant = RestaurantSystem.find_restaurant_by_id(current_user.restaurant_id)
@@ -186,4 +194,4 @@
 
 @app.route("/admin/dashboard")
 def dashboard():  # ruri
-    return render_template("admin/dashboard.html")
+    return render_template("templates/admin/dashboard.html")
Index: application/templates/admin/restaurant.html
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><!-- ruri flora newman -->\n\n{% extends \"admin/admin_base.html\" %}\n{% block title %}Restaurant Details{% endblock %}\n\n{% from \"includes/_formHelper.html\" import render_field %}\n{% block head %}\n\n  <link rel=\"stylesheet\" href=\"https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css\"\n        integrity=\"sha384-9aIt2nRpC12Uk9gS9baDl411NQApFmC26EwAOH8WgZl5MYYxFfc+NcPb1dKGj7Sk\" crossorigin=\"anonymous\">\n  <script src=\"https://code.jquery.com/jquery-3.3.1.slim.min.js\"\n          integrity=\"sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo\"\n          crossorigin=\"anonymous\"></script>\n  <script src=\"https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js\"\n          integrity=\"sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1\"\n          crossorigin=\"anonymous\"></script>\n  <script src=\"https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js\"\n          integrity=\"sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM\"\n          crossorigin=\"anonymous\"></script>\n  <link rel=\"stylesheet\" href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css\">\n  <style>\n      {\n          box-sizing: border-box\n      ;\n      }\n      /* Set additional styling options for the columns*/\n      .column {\n          float: left;\n          width: 45%;\n          margin-bottom: 50px;\n      }\n\n      .row:after {\n          content: \"\";\n          display: table;\n          clear: both;\n      }\n\n      .row {\n          margin-top: 50px;\n          margin-right: 50px;\n          margin-left: 50px;\n      }\n\n      .form-group {\n          margin-top: 5px;\n      }\n\n      .form-row {\n          margin-top: 5px;\n      }\n\n      input::placeholder {\n          font-style: italic;\n          font-size: 13px;\n      }\n\n      .closehour {\n          visibility: hidden;\n      }\n\n      label {\n          font-size: 15.5px;\n      }\n\n      #rest_logo {\n          margin-left: 260px;\n      }\n\n\n      input[type='submit'], button, [aria-label] {\n          cursor: pointer;\n      }\n\n      /*#edit-box {*/\n      /*    display: none;*/\n      /*    max-width: 80%;*/\n      /*    margin-top: 10px;*/\n      /*}*/\n\n      input{\n        width: 100%;\n        padding: 1em;\n        line-height: 1.4;\n        background-color: #f9f9f9;\n        border: 1px solid #e5e5e5;\n        border-radius: 3px;\n        -webkit-transition: 0.35s ease-in-out;\n        -moz-transition: 0.35s ease-in-out;\n        -o-transition: 0.35s ease-in-out;\n        transition: 0.35s ease-in-out;\n        transition: all 0.35s ease-in-out;\n      }\n\n      td {\n          background-color: transparent;\n          padding-right: 10px;\n          text-align: left;\n      }\n  </style>\n{% endblock %}\n\n{% block content %}\n  <!-- start of navigation bar-->\n  <nav>\n    <div class=\"nav nav-tabs\" id=\"nav-tab\" role=\"tablist\">\n      <button class=\"nav-link active\" id=\"nav-settings-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#nav-settings\"\n              type=\"button\" role=\"tab\" aria-controls=\"nav-settings\" aria-selected=\"true\">Restaurant Information\n      </button>\n      <button class=\"nav-link\" id=\"nav-restrictions-tab\" data-bs-toggle=\"tab\" data-bs-target=\"#nav-restrictions\"\n              type=\"button\" role=\"tab\" aria-controls=\"nav-restrictions\" aria-selected=\"false\">Food Restrictions\n      </button>\n    </div>\n  </nav>\n\n  <!-- start of division row-->\n  <h2 style=\"margin-top: 50px; margin-left: 10px\"><u>Your Restaurant's details: </u></h2>\n\n  <form method=\"POST\" action=\"\" enctype=\"multipart/form-data\">\n    <div class=\"row\" >\n      <div class=\"column\"> <!--start of column one content-->\n        <div class=\"form-row\">\n          <div class=\"form-group col-md-6\">\n            {{ render_field(form.rest_name, class=\"form-control\", placeholder=\"The Saffron Boutique\") }}\n            <!--    <input type=\"text\" class=\"form-control\" id=\"rest_name\" placeholder=\"The Saffron Boutique\">-->\n          </div>\n        </div>\n        <div class=\"form-row\">\n          <div class=\"form-group col-md-6\">\n            {{ render_field(form.rest_contact, class=\"form-control\", placeholder=\"89898989\") }}\n          </div>\n        </div>\n\n        <div class=\"form-row\">\n          <div class=\"form-group col-md-3\">\n            {{ render_field(form.rest_hour_open, class=\"form-control\") }}\n          </div>\n          <div class=\"form-group col-md-1\">\n            <label class=\"closehour\">DUMMY TEXT</label>\n            <h6 style=\"margin-top: -13px; margin-left: 12px;\">TO</h6>\n          </div>\n          <div class=\"form-group col-md-3\">\n            {{ render_field(form.rest_hour_close, class=\"form-control\", style=\"margin-top: 7px; margin-left:7px;\") }}\n\n          </div>\n        </div>\n\n        <div class=\"form-row\">\n          {{ render_field(form.rest_address1, class=\"form-control\", placeholder=\"123 Floral Street\") }}\n        </div>\n\n        <div class=\"form-row\">\n          <div class=\"form-group col-md-10\">\n            {{ render_field(form.rest_address2, class=\"form-control\", placeholder=\"Apartment, Studio, or Floor\") }}\n          </div>\n          <div class=\"form-group col-md-2\">\n            {{ render_field(form.rest_postcode, class=\"form-control\", placeholder=\"123456\") }}\n          </div>\n        </div>\n      </div> <!--end of column one content-->\n\n      <div class=\"column\" style=\"margin-left: 80px;\">\n        <div class=\"form-row\">\n          <div class=\"form-group col-md-5\">\n            <label for=\"rest_logo\">Logo</label>\n<!--            <input type=\"file\" id=\"rest_logo\" name=\"logo\">-->\n            <input style=\"margin-left: 0px;\" class=\"form-control\" type=\"file\" name=\"rest_logo\" id=\"rest_logo\" placeholder=\"Upload your logo\"/>\n          </div>\n        </div>\n\n\n        <div class=\"form-row\">\n          <div class=\"form-group col-md-8\">\n            {{ render_field(form.rest_bank, class=\"form-control\", placeholder=\"123456\") }}\n          </div>\n        </div>\n        <div class=\"form-row\">\n          <div class=\"form-group col-md-12\">\n            {{ render_field(form.rest_desc, class=\"form-control\", placeholder=\"A little something about your restaurant...\") }}\n          </div>\n        </div>\n\n        <h4 style=\"margin-top: 30px\">Delivery charges over distance ($):</h4>\n\n        <div class=\"form-row\" style=\"position: relative\">\n          <div class=\"form-group col-md-2\">\n            {{ render_field(form.rest_del1, class=\"form-control\", placeholder=\"1.20\") }}\n          </div>\n          <div class=\"form-group col-md-2\">\n            {{ render_field(form.rest_del2, class=\"form-control\", placeholder=\"2.40\") }}\n          </div>\n          <div class=\"form-group col-md-2\">\n            {{ render_field(form.rest_del3, class=\"form-control\", placeholder=\"3.60\") }}\n          </div>\n          <div class=\"form-group col-md-2\">\n            {{ render_field(form.rest_del4, class=\"form-control\", placeholder=\"4.80\") }}\n          </div>\n          <div class=\"form-group col-md-2\">\n            {{ render_field(form.rest_del5, class=\"form-control\", placeholder=\"6.00\") }}\n          </div>\n<!--          <div class=\"form-group col-md-2\">-->\n<!--            <button type=\"submit\" class=\"btn btn-primary\" style=\"margin-top: 33px\">Update</button>-->\n<!--          </div>-->\n\n        </div>\n\n        <div class=\"form-group row\">\n          <div class=\"col-sm-2\">\n            <button type=\"submit\" class=\"btn btn-primary\" style=\"margin-left: 420px\">Update</button>\n          </div>\n        </div>\n      </div>\n    </div>\n\n  </form>\n\n{% endblock %}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/application/templates/admin/restaurant.html b/application/templates/admin/restaurant.html
--- a/application/templates/admin/restaurant.html	(revision 40420adf25f454adf4c2c46c8eb7fbadbb8da3fd)
+++ b/application/templates/admin/restaurant.html	(date 1643175646530)
@@ -163,8 +163,8 @@
         <div class="form-row">
           <div class="form-group col-md-5">
             <label for="rest_logo">Logo</label>
-<!--            <input type="file" id="rest_logo" name="logo">-->
-            <input style="margin-left: 0px;" class="form-control" type="file" name="rest_logo" id="rest_logo" placeholder="Upload your logo"/>
+                <input type="file" class="form-control" name="rest_logo" id="rest_logo" accept="image/*">
+{#            <input style="margin-left: 0px;" class="form-control" type="file" name="rest_logo" id="rest_logo" placeholder="Upload your logo"/>#}
           </div>
         </div>
 
